From 1170000ceeb17767f834b3466c7f5c0ebd34604e Mon Sep 17 00:00:00 2001
From: Martyn Taylor <mtaylor@redhat.com>
Date: Wed, 15 Mar 2017 20:03:13 +0000
Subject: [PATCH 1/3] m

---
 .../apache/activemq/artemis/core/replication/ReplicationEndpoint.java   | 2 +-
 .../apache/activemq/artemis/core/replication/ReplicationManager.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/artemis-server/src/main/java/org/apache/activemq/artemis/core/replication/ReplicationEndpoint.java b/artemis-server/src/main/java/org/apache/activemq/artemis/core/replication/ReplicationEndpoint.java
index 1a07adc..23f9c40 100644
--- a/artemis-server/src/main/java/org/apache/activemq/artemis/core/replication/ReplicationEndpoint.java
+++ b/artemis-server/src/main/java/org/apache/activemq/artemis/core/replication/ReplicationEndpoint.java
@@ -209,7 +209,7 @@ public final class ReplicationEndpoint implements ChannelHandler, ActiveMQCompon
          ActiveMQServerLogger.LOGGER.errorHandlingReplicationPacket(e, packet);
          response = new ActiveMQExceptionMessage(ActiveMQMessageBundle.BUNDLE.replicationUnhandledError(e));
       }
-      channel.send(response);
+      channel.sendAndFlush(response);
    }
 
    /**
diff --git a/artemis-server/src/main/java/org/apache/activemq/artemis/core/replication/ReplicationManager.java b/artemis-server/src/main/java/org/apache/activemq/artemis/core/replication/ReplicationManager.java
index a82ce07..97bd077 100644
--- a/artemis-server/src/main/java/org/apache/activemq/artemis/core/replication/ReplicationManager.java
+++ b/artemis-server/src/main/java/org/apache/activemq/artemis/core/replication/ReplicationManager.java
@@ -356,7 +356,7 @@ public final class ReplicationManager implements ActiveMQComponent, ReadyListene
       synchronized (replicationLock) {
          if (enabled) {
             pendingTokens.add(repliToken);
-            replicatingChannel.send(packet);
+            replicatingChannel.sendAndFlush(packet);
          } else {
             // Already replicating channel failed, so just play the action now
             runItNow = true;
-- 
2.7.4

